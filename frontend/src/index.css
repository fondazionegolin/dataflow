@tailwind base;
@tailwind components;
@tailwind utilities;

@layer utilities {
  @keyframes gradient {
    0% {
      background-position: 0% 50%;
    }
    50% {
      background-position: 100% 50%;
    }
    100% {
      background-position: 0% 50%;
    }
  }
  
  .animate-gradient {
    animation: gradient 2s ease infinite;
  }
}

@layer base {
  :root {
    --background: 0 0% 100%;
    --foreground: 222.2 84% 4.9%;
    --card: 0 0% 100%;
    --card-foreground: 222.2 84% 4.9%;
    --popover: 0 0% 100%;
    --popover-foreground: 222.2 84% 4.9%;
    --primary: 221.2 83.2% 53.3%;
    --primary-foreground: 210 40% 98%;
    --secondary: 210 40% 96.1%;
    --secondary-foreground: 222.2 47.4% 11.2%;
    --muted: 210 40% 96.1%;
    --muted-foreground: 215.4 16.3% 46.9%;
    --accent: 210 40% 96.1%;
    --accent-foreground: 222.2 47.4% 11.2%;
    --destructive: 0 84.2% 60.2%;
    --destructive-foreground: 210 40% 98%;
    --border: 214.3 31.8% 91.4%;
    --input: 214.3 31.8% 91.4%;
    --ring: 221.2 83.2% 53.3%;
    --radius: 0.5rem;
  }

  .dark {
    --background: 0 0% 15%;
    --foreground: 0 0% 98%;
    --card: 0 0% 10%;
    --card-foreground: 0 0% 98%;
    --popover: 0 0% 10%;
    --popover-foreground: 0 0% 98%;
    --primary: 217.2 91.2% 59.8%;
    --primary-foreground: 0 0% 98%;
    --secondary: 0 0% 20%;
    --secondary-foreground: 0 0% 98%;
    --muted: 0 0% 20%;
    --muted-foreground: 0 0% 65%;
    --accent: 0 0% 20%;
    --accent-foreground: 0 0% 98%;
    --destructive: 0 62.8% 30.6%;
    --destructive-foreground: 0 0% 98%;
    --border: 0 0% 25%;
    --input: 0 0% 20%;
    --ring: 217.2 91.2% 59.8%;
  }
}

@layer base {
  * {
    @apply border-border;
  }
  body {
    @apply bg-background text-foreground;
    font-feature-settings: "rlig" 1, "calt" 1;
  }
}

/* React Flow custom styles */
.react-flow__node {
  @apply rounded-lg shadow-md;
}

.react-flow__node.selected {
  /* Removed default ring, will use custom glow per node */
}

.react-flow__handle {
  @apply w-4 h-4 rounded-full;
  border: none !important;
  transition: box-shadow 0.25s cubic-bezier(0.4, 0, 0.2, 1) !important;
  z-index: 10;
  box-shadow: 0 0 0 0px rgba(99, 102, 241, 1);
}

.react-flow__handle.handle-active {
  box-shadow: 0 0 0 5px rgba(99, 102, 241, 0.6), 0 4px 12px rgba(0, 0, 0, 0.3) !important;
  z-index: 100;
}

.react-flow__edge-path {
  stroke-width: 2;
  transition: stroke 0.3s ease;
}

.react-flow__edge.selected .react-flow__edge-path {
  @apply stroke-primary;
}

/* Edge colors based on target node category */
.react-flow__edge.edge-sources .react-flow__edge-path {
  stroke: #22c55e;
}

.react-flow__edge.edge-ai_sources .react-flow__edge-path {
  stroke: #ec4899;
}

.react-flow__edge.edge-transform .react-flow__edge-path {
  stroke: #3b82f6;
}

.react-flow__edge.edge-visualization .react-flow__edge-path {
  stroke: #f97316;
}

.react-flow__edge.edge-machine_learning .react-flow__edge-path {
  stroke: #a855f7;
}

.react-flow__edge.edge-nlp .react-flow__edge-path {
  stroke: #6366f1;
}

.react-flow__edge.edge-clustering .react-flow__edge-path {
  stroke: #14b8a6;
}

.react-flow__edge.edge-llm .react-flow__edge-path {
  stroke: #8b5cf6;
}

.react-flow__edge.edge-images .react-flow__edge-path {
  stroke: #f43f5e;
}

.react-flow__edge.edge-mathematics .react-flow__edge-path {
  stroke: #eab308;
}

/* Dark Mode Styles - ComfyUI Style */
body.dark-mode {
  background-color: #2a2a2a !important;
}

body.dark-mode .react-flow__pane {
  background-color: #2a2a2a !important;
}

/* Dark mode - lighter dots for better visibility */
body.dark-mode .react-flow__background {
  background-color: #2a2a2a !important;
}

body.dark-mode .react-flow__background-pattern.dots,
body.dark-mode .react-flow__background circle {
  fill: #606060 !important;
  stroke: #606060 !important;
}

body.dark-mode svg.react-flow__background path {
  stroke: #505050 !important;
}

body.dark-mode .react-flow__node {
  background-color: #3a3a3a !important;
  color: #cccccc;
  border-radius: 8px !important;
  border: none !important;
}

body.dark-mode .react-flow__node > div {
  background-color: #3a3a3a !important;
  border: none !important;
}

/* Keep header colors vibrant in dark mode - no filter */
body.dark-mode .react-flow__node .font-medium,
body.dark-mode .react-flow__node .font-semibold {
  color: #ffffff !important;
}

/* Input fields - dark style */
body.dark-mode .react-flow__node input,
body.dark-mode .react-flow__node select,
body.dark-mode .react-flow__node textarea {
  background-color: #1e1e1e !important;
  color: #cccccc !important;
  border-color: #404040 !important;
}

body.dark-mode .react-flow__node input:focus,
body.dark-mode .react-flow__node select:focus,
body.dark-mode .react-flow__node textarea:focus {
  border-color: #505050 !important;
  outline: none !important;
  box-shadow: none !important;
}

body.dark-mode .react-flow__node input::placeholder {
  color: #666666 !important;
}

/* Hide number input spinners completely in dark mode */
body.dark-mode .react-flow__node input[type="number"]::-webkit-inner-spin-button,
body.dark-mode .react-flow__node input[type="number"]::-webkit-outer-spin-button {
  -webkit-appearance: none !important;
  appearance: none !important;
  display: none !important;
  margin: 0 !important;
}

body.dark-mode .react-flow__node input[type="number"] {
  -moz-appearance: textfield !important;
}

/* Text colors */
body.dark-mode .react-flow__node .text-gray-700,
body.dark-mode .react-flow__node .text-gray-600,
body.dark-mode .react-flow__node .text-gray-500 {
  color: #999999 !important;
}

body.dark-mode .react-flow__node .text-gray-800,
body.dark-mode .react-flow__node .text-gray-900 {
  color: #cccccc !important;
}

/* Background colors */
body.dark-mode .react-flow__node .bg-gray-100 {
  background-color: #1e1e1e !important;
}

body.dark-mode .react-flow__node .bg-gray-50 {
  background-color: #252525 !important;
}

body.dark-mode .react-flow__node .bg-white {
  background-color: #3a3a3a !important;
}

/* Borders */
body.dark-mode .react-flow__node .border-gray-200,
body.dark-mode .react-flow__node .border-gray-300 {
  border-color: #404040 !important;
}

/* Buttons */
body.dark-mode .react-flow__node button {
  background-color: #1e1e1e !important;
  color: #cccccc !important;
  border-color: #404040 !important;
}

body.dark-mode .react-flow__node button:hover {
  background-color: #353535 !important;
}

/* Shadows */
body.dark-mode .react-flow__node {
  box-shadow: 0 4px 6px rgba(0, 0, 0, 0.5) !important;
}

/* Handle labels - white in dark mode */
body.dark-mode .react-flow__node .text-xs.text-gray-600 {
  color: #ffffff !important;
  text-shadow: 0 1px 3px rgba(0, 0, 0, 0.8) !important;
}

/* Mathematics nodes - black text with transparency on yellow background */
[data-category="mathematics"] .text-white {
  color: rgba(0, 0, 0, 0.8) !important;
}

[data-category="mathematics"] .text-white\/70 {
  color: rgba(0, 0, 0, 0.6) !important;
}

[data-category="mathematics"] .font-medium.text-sm.text-white {
  color: rgba(0, 0, 0, 0.85) !important;
}

[data-category="mathematics"] .text-xs.text-white\/70 {
  color: rgba(0, 0, 0, 0.65) !important;
}

/* Mathematics nodes - buttons with white text - override dark mode */
body.dark-mode [data-category="mathematics"] button,
[data-category="mathematics"] button {
  color: white !important;
  background-color: inherit !important;
}

body.dark-mode [data-category="mathematics"] button.bg-blue-500,
[data-category="mathematics"] button.bg-blue-500 {
  background-color: #3b82f6 !important;
  color: white !important;
}

body.dark-mode [data-category="mathematics"] button.bg-green-500,
[data-category="mathematics"] button.bg-green-500 {
  background-color: #10b981 !important;
  color: white !important;
}

/* LogPanel dark mode styles - barra minimizzata scura, contenuto espanso chiaro */
body.dark-mode .log-panel {
  background-color: rgb(30 41 59) !important; /* slate-800 - grigio/blu scuro */
  border-color: rgb(51 65 85) !important; /* slate-700 */
}

/* Testo nella barra minimizzata - chiaro */
body.dark-mode .log-panel > div:first-child .log-panel-text {
  color: rgb(248 250 252) !important; /* slate-50 */
}

body.dark-mode .log-panel > div:first-child .log-panel-text-muted {
  color: rgb(203 213 225) !important; /* slate-300 */
}

body.dark-mode .log-panel > div:first-child .log-panel-badge {
  background-color: rgb(51 65 85) !important; /* slate-700 */
  color: rgb(226 232 240) !important; /* slate-200 */
}

/* Contenuto espanso - mantiene sfondo chiaro */
body.dark-mode .log-panel .max-h-64 {
  background-color: white !important;
}

body.dark-mode .log-panel-header {
  background-color: rgb(248 250 252) !important; /* slate-50 - chiaro */
  border-color: rgb(226 232 240) !important; /* slate-200 */
}

/* Testi nel contenuto espanso - scuri (tema chiaro) */
body.dark-mode .log-panel-header .log-panel-text-secondary {
  color: rgb(51 65 85) !important; /* slate-700 */
}

body.dark-mode .log-panel-header .log-panel-text-muted {
  color: rgb(100 116 139) !important; /* slate-500 */
}

body.dark-mode .log-panel-header .log-panel-badge {
  background-color: rgb(226 232 240) !important; /* slate-200 */
  color: rgb(51 65 85) !important; /* slate-700 */
}

/* Log entries - tema chiaro */
body.dark-mode .log-panel-text {
  color: rgb(15 23 42) !important; /* slate-900 */
}

body.dark-mode .log-panel-text-muted {
  color: rgb(100 116 139) !important; /* slate-500 */
}

body.dark-mode .log-panel-hover:hover {
  background-color: rgb(248 250 252) !important; /* slate-50 */
}

body.dark-mode .log-panel-divider {
  border-color: rgb(226 232 240) !important; /* slate-200 */
}

body.dark-mode .log-panel-details {
  background-color: rgb(241 245 249) !important; /* slate-100 */
  color: rgb(71 85 105) !important; /* slate-600 */
}

/* Tips - mantiene tema chiaro */
body.dark-mode .log-panel-tip {
  background-color: rgb(254 252 232) !important; /* yellow-50 */
  border-color: rgb(254 240 138) !important; /* yellow-200 */
}

body.dark-mode .log-panel-tip-icon {
  color: rgb(202 138 4) !important; /* yellow-600 */
}

body.dark-mode .log-panel-tip-title {
  color: rgb(113 63 18) !important; /* yellow-900 */
}

body.dark-mode .log-panel-tip-text {
  color: rgb(133 77 14) !important; /* yellow-800 */
}
